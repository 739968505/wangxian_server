<%@ page language="java" contentType="text/html; charset=utf-8"
    pageEncoding="utf-8"%>
<%@ page import="com.fy.engineserver.util.*,com.fy.engineserver.datasource.props.*,com.xuanzhi.tools.dbpool.*" %>
<%
HefuManager hm = HefuManager.getInstance();
StringBuffer message = new StringBuffer();
String operation = request.getParameter("operation");
if(operation != null && operation.equals("start")) {
	long start = System.currentTimeMillis();
	PooledDataSource ds = new PooledDataSource();
    ds.setAlias("hefu");
    ds.setCheckoutTimeout(120);
    ds.setDriverClassName("oracle.jdbc.driver.OracleDriver");
    ds.setUrl("jdbc:oracle:thin:@117.135.139.52:1521:ora10g");
    ds.setUsername("qianlong48");
    ds.setPassword("oracle4qianlong48");
    ds.setMaxActive(100);
    ds.setIdleTimeout(120);
    ds.initialize();
    hm.setDataSource(ds);
	ArticleEntityManager aem = ArticleEntityManager.getInstance();
	long oldIds[] = new long[]{8033782,
			8033782,
			28756057,
			28756057,
			35634199,
			35634198,
			35634197,
			40833479,
			35634196,
			35634195,
			35634194,
			35634193,
			38163713,
			38163714,
			35949442,
			38158010,
			35950052,
			35640510,
			38162340,
			35640514,
			35648183,
			35640797,
			35639529,
			35648393,
			35639525,
			35639526,
			35647349,
			35639527,
			35640511,
			35640508,
			35640512,
			35640513,
			35640061,
			38333665,
			35643527,
			35640507,
			35646163,
			35641581,
			35646241,
			35641999,
			35643464,
			35952420,
			35918069,
			35641201,
			35621134,
			35618768,
			35621948,
			35622433,
			35895431,
			35619049,
			38632349,
			35619205,
			35621060,
			35618345,
			35621059,
			35619671,
			35620995,
			35620197,
			35619929,
			35621840,
			35619593,
			35621063,
			35619209,
			35619208,
			35620111,
			35956740,
			35620053,
			35940136,
			35619207,
			35619206,
			35619211,
			35619210,
			35620189,
			35980993,
			35620613,
			35993620,
			38950720,
			35717520,
			35863509,
			41208091,
			35619859,
			38861641,
			36924724,
			38858209,
			37404115,
			37404481,
			35619212,
			35619609,
			35619287,
			36617937,
			35619578,
			37404738,
			38105120,
			37823570,
			37079529,
			50204248,
			51062021,
			37825690,
			37812149,
			36904087,
			51156134,
			51155430,
			38865996,
			51148718,
			37166866,
			35621156,
			35629048,
			36924927,
			35618758,
			35616564,
			36093633,
			36270643,
			35618679,
			35618147,
			35617839,
			36086620,
			35617684,
			35616278,
			36092820,
			35617796,
			35616274,
			35616275,
			36098798,
			35617720,
			35763670,
			52673540,
			35617913,
			35617912,
			37131731,
			40345049,
			35612509,
			39833213,
			40344860,
			40345510,
			35617911,
			35617910,
			36270642,
			35609300,
			40344704,
			36096150,
			35618229,
			38843749,
			35753290,
			39801903,
			35612513,
			35618228,
			35617917,
			35618733,
			35617916,
			35612512,
			35617915,
			39802878,
			35617914,
			35618683,
			35618226,
			35618227,
			37149004,
			37148773,
			39807963,
			39807447,
			35610055,
			39803124,
			35613379,
			35612510,
			35618233,
			35615769,
			39806194,
			35618232,
			35612516,
			35618231,
			35616608,
			35618230,
			35626907,
			35625960,
			35641567,
			35750535,
			35628136,
			35729648,
			35627887,
			35627886,
			35893027,
			36605755,
			35627888,
			35628611,
			35627890,
			35627889,
			36210566,
			35627891,
			35627892,
			35627893,
			35724627,
			35896761,
			35909162,
			36203002,
			35732242,
			35641842,
			35840973,
			35762850,
			35728907,
			35643489,
			35640773,
			35623803,
			35728906,
			35630312,
			35730416,
			36615139,
			35652893,
			35649645,
			35726878,
			35630360,
			35629978,
			35629974,
			35629980,
			36120817,
			35734079,
			35724928,
			35630304,
			35625459,
			35730978,
			35629979,
			35855743,
			35630307,
			35630305,
			35630306,
			35630309,
			36950228,
			35630308,
			36119271,
			35630311,
			36952301,
			35630310,
			35858240,
			37613707,
			35629976,
			36950229,
			37612939,
			35619624,
			36105628,
			36253808,
			35952715,
			50200154,
			35947962,
			35796612,
			35621392,
			48903336,
			35621829,
			39347740,
			47907165,
			51049438,
			47675549,
			35876924,
			35672260,
			47910456,
			36092068,
			51157478,
			36462100,
			47908340,
			38885734,
			47910033,
			47910364,
			35623813,
			35720644,
			35678026,
			46272977,
			36240003,
			35990904,
			46209813,
			37324156,
			48035304,
			48035140,
			39900938,
			35722125,
			35635698,
			39900937,
			48028625,
			35625469,
			35625955,
			35625953,
			35625476,
			35625475,
			35625474,
			35625473,
			35625472,
			35625471,
			35630621,
			35631521,
			35627417,
			35627414,
			45044971,
			52347702,
			45044972,
			45071009,
			45044969,
			45044980,
			45044970,
			45044981,
			45044977,
			45044978,
			45044968,
			45044979,
			45044966,
			45044975,
			45044967,
			45044976,
			45051786,
			45204899,
			45045002,
			45048540,
			45045003,
			45044999,
			52354257,
			52089158,
			45044997,
			45074698,
			45044998,
			45045082,
			45074699,
			45066586,
			45044952,
			52328805,
			47568927,
			45056063,
			45045087,
			45106261,
			45070017,
			45051065,
			52349324,
			45192219,
			45045086,
			45056793,
			45055213,
			45048223,
			45045085,
			45051420,
			45045083,
			45045084,
			45070610,
			50301088,
			52357866,
			45071370,
			45051176,
			45064343,
			45069502,
			45045004,
			45110920,
			52080124,
			45052346,
			45045080,
			45052632,
			45110921,
			45045001,
			45045000,
			45109758,
			45050021,
			45049329,
			45045499,
			45045500,
			45052342,
			45052551,
			47679756,
			45106732,
			45062981,
			53118277,
			45108369,
			45107200,
			45072068,
			45072766,
			45109103,
			45045992,
			45045991,
			45045994,
			45045993,
			45045996,
			45045995,
			45110721,
			45048790,
			45045502,
			45045501,
			45045504,
			45045503,
			45045506,
			45045505,
			45045990,
			45045989,
			45114599,
			45122014,
			45114149,
			45114533,
			45046039,
			45047559,
			45123412,
			46247404,
			45046034,
			45114107,
			45107199,
			45046031,
			45113234,
			45113235,
			45046035,
			45114467,
			45796476,
			46033384,
			46249268,
			45048042,
			45113417,
			45181791,
			45183035,
			45219722,
			45182772,
			45112437,
			45816934,
			45112978,
			45114813,
			45109189,
			45049276,
			45177615,
			45046289,
			45046290,
			45046291,
			45046292,
			45046293,
			45046385,
			45046386,
			45046387,
			45048789,
			45046391,
			45046390,
			45051722,
			45369422,
			45369580,
			45046458,
			45046396,
			45046077,
			45046076,
			45046079,
			45046078,
			45046278,
			45046277,
			45046279,
			45048270,
			45046281,
			45046280,
			45046283,
			45046282,
			45046286,
			45046284,
			45046288,
			45046287,
			45045960,
			45045961,
			45045958,
			45045959,
			45046066,
			45046067,
			45046064,
			45046065,
			45046070,
			45046071,
			45046068,
			45046069,
			45046074,
			45046075,
			45046072,
			45046073,
			45046051,
			45046050,
			45183758,
			45183441,
			45046053,
			45046052,
			45049679,
			45049071,
			45046057,
			45046056,
			45046055,
			45046054,
			45045957,
			45045956,
			45045955,
			45045954,
			45047069,
			45047070,
			45047071,
			46176393,
			45047065,
			45047066,
			45047067,
			45047068,
			45047076,
			45047077,
			45047078,
			45226673,
			46173923,
			45229258,
			45047074,
			45047075,
			45046500,
			45227044,
			46175193,
			45046618,
			45046498,
			45046616,
			45046499,
			45046617,
			45225340,
			45046612,
			45047064,
			45228770,
			46177716,
			45046619,
			45225341,
			45227955,
			45050450,
			45046392,
			45046389,
			45050656,
			45048081,
			45046388,
			45431955,
			45432577,
			45046615,
			45046497,
			45048565,
			45046496,
			45046494,
			45046495,
			45046493,
			45046614,
			45046462,
			45046401,
			45371568,
			45046461,
			45046403,
			45046460,
			45046397,
			45046459,
			45431135,
			45046402,
			45046465,
			45046400,
			45046464,
			45046399,
			45046463,
			45046398,
			45047313,
			45048802,
			45050597,
			45047314,
			45047317,
			45050539,
			45047751,
			45049463,
			45047112,
			45047307,
			45047310,
			45855284,
			45047312,
			45047311,
			45047315,
			45047316,
			45047301,
			45047302,
			45047303,
			46342166,
			45047304,
			45047305,
			45047306,
			46341025,
			45855183,
			45856164,
			46344345,
			46344346,
			45863506,
			46350315,
			46346628,
			45047300,
			45047243,
			45047242,
			45047241,
			45047240,
			45856085,
			46353897,
			45047105,
			45047244,
			45047094,
			45047093,
			45045976,
			45047092,
			45047239,
			45047238,
			45047237,
			45047095,
			45045973,
			45047090,
			45047089,
			46177216,
			45047091,
			45045975,
			45048968,
			45045974,
			45045970,
			45047080,
			45045969,
			45047079,
			45047088,
			45045972,
			45045971,
			45047081,
			45048072,
			45258892,
			45048074,
			45048073,
			45048064,
			45048057,
			45388138,
			45048058,
			45247544,
			45048055,
			45048063,
			45048056,
			45397395,
			45397394,
			45048054,
			45048053,
			45048060,
			45393102,
			45397983,
			45397984,
			45171874,
			45396592,
			45397485,
			45397488,
			45387880,
			45389555,
			45164477,
			45389731,
			45048028,
			45048029,
			45048030,
			45392706,
			45048027,
			45398525,
			45048026,
			45048025,
			45087809,
			45048024,
			45048023,
			45048051,
			45048021,
			45048020,
			45048019,
			45048018,
			45048017,
			45048016,
			45048015,
			45048014,
			45047655,
			45047656,
			45047653,
			45047654,
			45047652,
			45047758,
			45047651,
			45047757,
			45051066,
			45047756,
			45047650,
			45047755,
			45047754,
			45047649,
			45047752,
			45047753,
			45048534,
			45048533,
			45048532,
			45048301,
			45048542,
			45048536,
			45048541,
			45048535,
			45048538,
			45048544,
			45048537,
			45048543,
			45048547,
			45048546,
			45048539,
			45048545,
			45048645,
			45048782,
			45048548,
			45048781,
			45048784,
			45062644,
			45048783,
			45052818,
			45048786,
			45048787,
			45062645,
			45048785,
			45199924,
			45226801,
			45048788,
			45136750,
			45048076,
			45048075,
			45169689,
			45048077,
			45048079,
			49170323};
	long newIds[] = new long[]{70528312,
			70528312,
			70766908,
			70766908,
			71144847,
			71144846,
			71144845,
			71144844,
			71144843,
			71144842,
			71144841,
			71144840,
			71144884,
			71144885,
			71144886,
			71144887,
			71144880,
			71144881,
			71144882,
			71144883,
			71144892,
			71144893,
			71144894,
			71144895,
			71144888,
			71144889,
			71144890,
			71144891,
			71144869,
			71144868,
			71144871,
			71144870,
			71144865,
			71144864,
			71144867,
			71144866,
			71144877,
			71144876,
			71144879,
			71144878,
			71144873,
			71144872,
			71144875,
			71144874,
			71144520,
			71144521,
			71144522,
			71144523,
			71144524,
			71144525,
			71144526,
			71144527,
			71144512,
			71144513,
			71144514,
			71144515,
			71144516,
			71144517,
			71144518,
			71144519,
			71144537,
			71144536,
			71144539,
			71144538,
			71144541,
			71144540,
			71144543,
			71144542,
			71144529,
			71144528,
			71144531,
			71144530,
			71144533,
			71144532,
			71144535,
			71144534,
			71144554,
			71144555,
			71144552,
			71144553,
			71144558,
			71144559,
			71144556,
			71144557,
			71144546,
			71144547,
			71144544,
			71144545,
			71144550,
			71144551,
			71144548,
			71144549,
			71144571,
			71144570,
			71144569,
			71144568,
			71144575,
			71144574,
			71144573,
			71144572,
			71144563,
			71144562,
			71144561,
			71144560,
			71144567,
			71144566,
			71144565,
			71144564,
			71144460,
			71144461,
			71144462,
			71144463,
			71144456,
			71144457,
			71144458,
			71144459,
			71144452,
			71144453,
			71144454,
			71144455,
			71144448,
			71144449,
			71144450,
			71144451,
			71144477,
			71144476,
			71144479,
			71144478,
			71144473,
			71144472,
			71144475,
			71144474,
			71144469,
			71144468,
			71144471,
			71144470,
			71144465,
			71144464,
			71144467,
			71144466,
			71144494,
			71144495,
			71144492,
			71144493,
			71144490,
			71144491,
			71144488,
			71144489,
			71144486,
			71144487,
			71144484,
			71144485,
			71144482,
			71144483,
			71144480,
			71144481,
			71144511,
			71144510,
			71144509,
			71144508,
			71144507,
			71144506,
			71144505,
			71144504,
			71144503,
			71144502,
			71144501,
			71144500,
			71144499,
			71144498,
			71144497,
			71144496,
			71144641,
			71144640,
			71144643,
			71144642,
			71144645,
			71144644,
			71144647,
			71144646,
			71144649,
			71144648,
			71144651,
			71144650,
			71144653,
			71144652,
			71144655,
			71144654,
			71144656,
			71144657,
			71144658,
			71144659,
			71144660,
			71144661,
			71144662,
			71144663,
			71144664,
			71144665,
			71144666,
			71144667,
			71144668,
			71144669,
			71144670,
			71144671,
			71144675,
			71144674,
			71144673,
			71144672,
			71144679,
			71144678,
			71144677,
			71144676,
			71144683,
			71144682,
			71144681,
			71144680,
			71144687,
			71144686,
			71144685,
			71144684,
			71144690,
			71144691,
			71144688,
			71144689,
			71144694,
			71144695,
			71144692,
			71144693,
			71144698,
			71144699,
			71144696,
			71144697,
			71144702,
			71144703,
			71144700,
			71144701,
			71144581,
			71144580,
			71144583,
			71144582,
			71144577,
			71144576,
			71144579,
			71144578,
			71144589,
			71144588,
			71144591,
			71144590,
			71144585,
			71144584,
			71144587,
			71144586,
			71144596,
			71144597,
			71144598,
			71144599,
			71144592,
			71144593,
			71144594,
			71144595,
			71144604,
			71144605,
			71144606,
			71144607,
			71144600,
			71144601,
			71144602,
			71144603,
			71144615,
			71144614,
			71144613,
			71144612,
			71144611,
			71144610,
			71144609,
			71144608,
			71144623,
			71144622,
			71144621,
			71144620,
			71144619,
			71144618,
			71144617,
			71144616,
			71144630,
			71144631,
			71144628,
			71144629,
			71394700,
			71394701,
			71394702,
			71394703,
			71394696,
			71394697,
			71394698,
			71394699,
			71394692,
			71394693,
			71394694,
			71394695,
			71394688,
			71394689,
			71394690,
			71394691,
			71394717,
			71394716,
			71394719,
			71394718,
			71394713,
			71394712,
			71394715,
			71394714,
			71394709,
			71394708,
			71394711,
			71394710,
			71394705,
			71394704,
			71394707,
			71394706,
			71394734,
			71394735,
			71394732,
			71394733,
			71394730,
			71394731,
			71394728,
			71394729,
			71394726,
			71394727,
			71394724,
			71394725,
			71394722,
			71394723,
			71394720,
			71394721,
			71394751,
			71394750,
			71394749,
			71394748,
			71394747,
			71394746,
			71394745,
			71394744,
			71394743,
			71394742,
			71394741,
			71394740,
			71394739,
			71394738,
			71394737,
			71394736,
			71394760,
			71394761,
			71394762,
			71394763,
			71394764,
			71394765,
			71394766,
			71394767,
			71394752,
			71394753,
			71394754,
			71394755,
			71394756,
			71394757,
			71394758,
			71394759,
			71394777,
			71394776,
			71394779,
			71394778,
			71394781,
			71394780,
			71394783,
			71394782,
			71394769,
			71394768,
			71394771,
			71394770,
			71394773,
			71394772,
			71394775,
			71394774,
			71394794,
			71394795,
			71394792,
			71394793,
			71394798,
			71394799,
			71394796,
			71394797,
			71394786,
			71394787,
			71394784,
			71394785,
			71394790,
			71394791,
			71394788,
			71394789,
			71394811,
			71394810,
			71394809,
			71394808,
			71394815,
			71394814,
			71394813,
			71394812,
			71394803,
			71394802,
			71394801,
			71394800,
			71394807,
			71394806,
			71394805,
			71394804,
			71394864,
			71394865,
			71394866,
			71394867,
			71394868,
			71394869,
			71394870,
			71394871,
			71394872,
			71394873,
			71394874,
			71394875,
			71394876,
			71394877,
			71394878,
			71394879,
			71394849,
			71394848,
			71394851,
			71394850,
			71394853,
			71394852,
			71394855,
			71394854,
			71394857,
			71394856,
			71394859,
			71394858,
			71394861,
			71394860,
			71394863,
			71394862,
			71394834,
			71394835,
			71394832,
			71394833,
			71394838,
			71394839,
			71394836,
			71394837,
			71394842,
			71394843,
			71394840,
			71394841,
			71394846,
			71394847,
			71394844,
			71394845,
			71394819,
			71394818,
			71394817,
			71394816,
			71394823,
			71394822,
			71394821,
			71394820,
			71394827,
			71394826,
			71394825,
			71394824,
			71394831,
			71394830,
			71394829,
			71394828,
			71394932,
			71394933,
			71394934,
			71394935,
			71394928,
			71394929,
			71394930,
			71394931,
			71394940,
			71394941,
			71394942,
			71394943,
			71394936,
			71394937,
			71394938,
			71394939,
			71394917,
			71394916,
			71394919,
			71394918,
			71394913,
			71394912,
			71394915,
			71394914,
			71394925,
			71394924,
			71394927,
			71394926,
			71394921,
			71394920,
			71394923,
			71394922,
			71394902,
			71394903,
			71394900,
			71394901,
			71394898,
			71394899,
			71394896,
			71394897,
			71394910,
			71394911,
			71394908,
			71394909,
			71394906,
			71394907,
			71394904,
			71394905,
			71394887,
			71394886,
			71394885,
			71394884,
			71394883,
			71394882,
			71394881,
			71394880,
			71394895,
			71394894,
			71394893,
			71394892,
			71394891,
			71394890,
			71394889,
			71394888,
			71395001,
			71395000,
			71395003,
			71395002,
			71395005,
			71395004,
			71395007,
			71395006,
			71394993,
			71394992,
			71394995,
			71394994,
			71394997,
			71394996,
			71394999,
			71394998,
			71394984,
			71394985,
			71394986,
			71394987,
			71394988,
			71394989,
			71394990,
			71394991,
			71394976,
			71394977,
			71394978,
			71394979,
			71394980,
			71394981,
			71394982,
			71394983,
			71394971,
			71394970,
			71394969,
			71394968,
			71394975,
			71394974,
			71394973,
			71394972,
			71394963,
			71394962,
			71394961,
			71394960,
			71394967,
			71394966,
			71394965,
			71394964,
			71394954,
			71394955,
			71394952,
			71394953,
			71394958,
			71394959,
			71394956,
			71394957,
			71394946,
			71394947,
			71394944,
			71394945,
			71394950,
			71394951,
			71394948,
			71394949,
			71395069,
			71395068,
			71395071,
			71395070,
			71395065,
			71395064,
			71395067,
			71395066,
			71395061,
			71395060,
			71395063,
			71395062,
			71395057,
			71395056,
			71395059,
			71395058,
			71395052,
			71395053,
			71395054,
			71395055,
			71395048,
			71395049,
			71395050,
			71395051,
			71395044,
			71395045,
			71395046,
			71395047,
			71395040,
			71395041,
			71395042,
			71395043,
			71395039,
			71395038,
			71395037,
			71395036,
			71395035,
			71395034,
			71395033,
			71395032,
			71395031,
			71395030,
			71395029,
			71395028,
			71395027,
			71395026,
			71395025,
			71395024,
			71395022,
			71395023,
			71395020,
			71395021,
			71395018,
			71395019,
			71395016,
			71395017,
			71395014,
			71395015,
			71395012,
			71395013,
			71395010,
			71395011,
			71395008,
			71395009,
			71395107,
			71395106,
			71395105,
			71395104,
			71395111,
			71395110,
			71395109,
			71395108,
			71395115,
			71395114,
			71395113,
			71395112,
			71395119,
			71395118,
			71395117,
			71395116,
			71395122,
			71395123,
			71395120,
			71395121,
			71395126,
			71395127,
			71395124,
			71395125,
			71395130,
			71395131,
			71395128,
			71395129,
			71395134,
			71395135,
			71395132,
			71395133,
			71395073,
			71395072,
			71395075,
			71395074,
			71395077,
			71555203};
	for(int i=0; i<oldIds.length; i++) {
		ArticleEntity entity = hm.getHefuArticleEntityById(oldIds[i], null);
		if(entity == null) {
			hm.logger.error("hefu entity is null ["+oldIds[i]+"]");
			out.println("entity null ["+oldIds[i]+"]<br>");
			continue;
		}
		entity.setId(newIds[i]);
		aem.saveEntity(entity);
		//更新此物品镶嵌的物品id
		if(entity instanceof EquipmentEntity) {
			EquipmentEntity ee = (EquipmentEntity)entity;
			ArticleEntity inlays[] = ee.getInlayEntites();
			for(int j=0; j<inlays.length; j++) {
				if(inlays[j] != null) {
					ArticleEntity ninlay = hm.importArticleEntity(inlays[j], null);
					if(ninlay != null) {
						inlays[j] = ninlay;
					}
				}
			}
			ee.setInlayEntites(inlays);
		}
		hm.logger.info("[导入物品] [成功] ["+oldIds[i]+"] ["+newIds[i]+"] ["+entity.getArticleName()+"] ["+(System.currentTimeMillis()-start)+"ms]");
		out.println("[导入物品] [成功] ["+oldIds[i]+"] ["+newIds[i]+"] ["+entity.getArticleName()+"] ["+(System.currentTimeMillis()-start)+"ms]<br>");
	}
} 
%>
<%@include file="IPManager.jsp" %><html>
<script>
function start() {
	document.getElementById("operation").value="start";
	document.f1.submit();
}
</script>
<body>
<%
	if(message.length() > 0){
		out.println("<h1>"+message.toString()+"</h1>");
	}
 %>
<form name=f1 action="hefu_article.jsp">
	<input type=button name="bt1" value="开始导入物品" onclick="start()">
	<input type=hidden name=operation id=operation value="">
</form>
</body>
</html>
